import{c}from"./chunk-MC5SZHMA.js";import{B as x,C as V,D as j,E as q,G as E,I as L,K as g,M as p,a as $,b as m,f as w,g as b,k as R,m as v,p as a,q as r,u as D,w as f,x as M,z as T}from"./chunk-UHKDLVDU.js";var k=t=>({loading:c(t.loading$,{initialValue:!0}),error:c(t.error$),success:c(t.success$,{initialValue:!0}),data:c(t.data$,{initialValue:null})}),A=(t,l,e,s={})=>{let{attempts:B=3,timeout:C=1e3}=s,i=new b(!1),u=new b(void 0),y=r([i,u]).pipe(a(([n,o])=>n||!o)),S=new w,F=i.pipe(f(n=>!n)),I=M(F,S).pipe(j(1)),O=r([i,y]).pipe(f(([n,o])=>!n&&o)),P=n=>v(n).pipe(p(()=>{i.next(!0),u.next(void 0)}),g(l),p({error:()=>S.next()}),E({count:B,delay:(o,Y)=>D(C*Y)}),p({error:o=>u.next(o)}),T(()=>R),p({next:()=>i.next(!1),complete:()=>i.next(!1)}),x(()=>O),a(o=>e(o,n))),d=()=>n=>n.pipe(q(),V(0),L(1)),U=t.pipe(x(()=>I),g(P),d()),h={loading$:i.pipe(d()),error$:u.pipe(d()),success$:y.pipe(d()),data$:U};return m($({},h),{toSignal:()=>k(h)})},G=t=>{let l={loading$:r(t.map(({loading$:e})=>e)).pipe(a(e=>e.some(s=>s))),error$:r(t.map(({error$:e})=>e)).pipe(a(e=>e.some(s=>s))),success$:r(t.map(({success$:e})=>e)).pipe(a(e=>e.every(s=>s))),data$:r(t.map(({data$:e})=>e))};return m($({},l),{toSignal:()=>k(l)})};export{A as a,G as b};
