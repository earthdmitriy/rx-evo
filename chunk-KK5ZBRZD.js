import{c as X,d as Y,e as Z,f as ee,g as te}from"./chunk-GBDNDGCT.js";import{a as Q}from"./chunk-XFDKH5E3.js";import{a as W,b as G,c as N}from"./chunk-MC5SZHMA.js";import{a as U,b as J,c as K}from"./chunk-Z6AK2GEV.js";import{a as q}from"./chunk-2EMY2H7W.js";import{b as H}from"./chunk-D7C7R5DL.js";import{Ba as p,Da as a,Eb as O,Fb as w,Ha as d,I as A,Ia as h,Ja as S,K as M,Ka as s,M as E,S as r,Sa as _,T as P,U as R,Z as F,_a as B,a as D,b as $,ea as z,fb as I,gb as b,ib as m,m as j,ma as l,mb as x,p as C,rb as L,ta as y,ub as V,w as T}from"./chunk-UHKDLVDU.js";function oe(e,i,t){!i&&R(e);let o=i??r(F);return t?P(o,t):o}function u(e,i){let t=oe(u,i?.injector),o;return m(()=>(o||(o=z(()=>N(e,$(D({},i),{injector:t})))),o()))}var k=e=>{let{input:i,loader:t,processResponse:o=f=>f,attempts:n,timeout:c,destroyRef:g=ee()}=e,re=!g,v=(i?G(i).pipe(T(Boolean)):j(!0)).pipe(M(f=>t(f).pipe(C(pe=>o(pe,f)),te(n,c))),g?W(g):E(),A({bufferSize:1,refCount:re}));return{data:u(v.pipe(T(Z)),{initialValue:null}),error:u(v.pipe(C(Y)),{initialValue:!1}),loading:u(v.pipe(C(X)),{initialValue:!0})}},ie=(e,i)=>({loading:m(()=>e.map(t=>t.loading()).some(t=>t)),error:m(()=>e.map(t=>t.error()).some(t=>t)),data:m(()=>{if(e.map(n=>n.error()).some(n=>n))return null;let o=e.map(n=>n.data());return o.some(n=>n===null)?null:i(o)})});function ce(e,i){e&1&&s(0,"app-generic-error",1)}function le(e,i){e&1&&s(0,"app-client-info",2),e&2&&d("displayData",i)}function se(e,i){e&1&&s(0,"app-generic-error",4)}function me(e,i){e&1&&s(0,"app-client-bucket",5),e&2&&d("bucket",i)}function de(e,i){if(e&1&&(h(0,"div"),p(1,se,1,0,"app-generic-error",4),p(2,me,1,1,"app-client-bucket",5),S()),e&2){let t,o=_();B("loading",o.populatedBucketStore.loading()),l(),a(o.populatedBucketStore.error()?1:-1),l(),a((t=o.populatedBucketStore.data())?2:-1,t)}}var ne=(()=>{class e{clientId=x();showBucket=x();clientsApi=r(H);bucketApi=r(J);productsApi=r(K);clientStore=k({input:this.clientId,loader:t=>this.clientsApi.getClient$(t)});productsStore=k({loader:()=>this.productsApi.allProducts$()});bucketStore=k({input:this.clientId,loader:t=>this.bucketApi.getClientBucket$(t)});populatedBucketStore=ie([this.bucketStore,this.productsStore],([t,o])=>O(t,o));static \u0275fac=function(o){return new(o||e)};static \u0275cmp=y({type:e,selectors:[["app-tiny-store"]],inputs:{clientId:[1,"clientId"],showBucket:[1,"showBucket"]},decls:5,vars:5,consts:[[1,"max-w-screen-lg"],["text","Failed to load client"],[3,"displayData"],[3,"loading"],["text","Failed to load bucket"],[3,"bucket"]],template:function(o,n){if(o&1&&(h(0,"div",0)(1,"div"),p(2,ce,1,0,"app-generic-error",1),p(3,le,1,1,"app-client-info",2),S(),p(4,de,3,4,"div",3),S()),o&2){let c;l(),B("loading",n.clientStore.loading()),l(),a(n.clientStore.error()?2:-1),l(),a((c=n.clientStore.data())?3:-1,c),l(),a(n.showBucket()?4:-1)}},dependencies:[q,U,Q],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}return e})();function ue(e,i){if(e&1&&(s(0,"app-tiny-store",0),I(1,"async")),e&2){let t=_();d("clientId",i)("showBucket",b(1,2,t.showBucket$)??!1)}}var He=(()=>{class e{counter$=r(w).clientId$;showBucket$=r(w).showBucket$;static \u0275fac=function(o){return new(o||e)};static \u0275cmp=y({type:e,selectors:[["app-tiny-store-input-wrapper"]],decls:2,vars:3,consts:[[3,"clientId","showBucket"]],template:function(o,n){if(o&1&&(p(0,ue,2,4,"app-tiny-store",0),I(1,"async")),o&2){let c;a((c=b(1,1,n.counter$))?0:-1,c)}},dependencies:[V,ne,L],encapsulation:2})}return e})();export{He as TinyStoreInputWrapperComponent};
