import{a as K}from"./chunk-IX3H5HXJ.js";import{c as J}from"./chunk-ZSEMYRIX.js";import{a as H}from"./chunk-XFDKH5E3.js";import{l as G,m as U}from"./chunk-EAS7AI6F.js";import{b as q}from"./chunk-D7C7R5DL.js";import{$a as p,Ba as f,Ca as j,Da as _,E as V,Fa as A,Ga as R,H as T,Ha as M,I as h,Ia as o,Ja as n,K as B,Oa as S,Qa as x,S as g,Sa as d,V as y,W as b,_a as I,bb as C,f as w,fb as s,g as $,gb as m,hb as L,ja as P,lb as N,ma as l,p as v,q as E,rb as O,sb as k,ta as D,ub as z,va as F}from"./chunk-UHKDLVDU.js";var Q=(()=>{class t{isIntersecting=N();el=g(P);hasInitialised=!1;observer=new IntersectionObserver(e=>{for(let i of e)i.isIntersecting&&this.isIntersecting.emit(i.isIntersecting)});constructor(){this.observer.observe(this.el.nativeElement)}ngOnDestroy(){this.observer.disconnect()}static \u0275fac=function(i){return new(i||t)};static \u0275dir=F({type:t,selectors:[["","appIntersectionobserver",""]],outputs:{isIntersecting:"isIntersecting"}})}return t})();var X=(t,a)=>a.clientId;function Y(t,a){if(t&1){let e=S();o(0,"tbody")(1,"tr")(2,"td",9)(3,"app-generic-error",10),x("reload",function(){y(e);let r=d();return b(r.stream.reload())}),n()()()()}t&2&&(l(3),M("showReload",!0))}function Z(t,a){if(t&1&&(o(0,"tr")(1,"td",12),p(2),n(),o(3,"td",13),p(4),n(),o(5,"td",13),p(6),s(7,"date"),n()()),t&2){let e=a.$implicit;l(2),C(" ",e.name," "),l(2),C(" ",e.email," "),l(2),C(" ",L(7,3,e.registeredAt,"medium")," ")}}function ee(t,a){t&1&&(o(0,"tr")(1,"td",14),p(2," No results "),n()())}function te(t,a){if(t&1&&(o(0,"tbody",11),A(1,Z,8,6,"tr",null,X),f(3,ee,3,0,"tr"),n()),t&2){let e=a;l(),R(e.data),l(2),_(e.data.length?-1:3)}}function ie(t,a){if(t&1&&(f(0,te,4,1,"tbody",11),s(1,"async")),t&2){let e,i=d();_((e=m(1,1,i.stream.value$))?0:-1,e)}}function ne(t,a){if(t&1){let e=S();o(0,"div",16),s(1,"async"),x("isIntersecting",function(){y(e);let r=d(),c=d();return b(r.next(c.page+1))}),p(2," Loading ... "),n()}if(t&2){let e=d(3);I("loading",m(1,2,e.stream.pending$))}}function oe(t,a){if(t&1&&f(0,ne,3,4,"div",15),t&2){let e=d();_(e.page<e.totalPages?0:-1)}}function re(t,a){if(t&1&&(f(0,oe,1,1),s(1,"async")),t&2){let e,i=d();_((e=m(1,1,i.pageSubject$))?0:-1,e)}}var ae=()=>({data:[],page:0,totalPages:1}),ye=(()=>{class t{fb=g(G);clientApiService=g(q);filters=this.fb.group({name:this.fb.control(""),email:this.fb.control(""),registeredBefore:this.fb.control(null),registeredAfter:this.fb.control(null)});formValue$=new w;pageSubject$=this.formValue$.pipe(v(()=>new $(1)),h(1));currentPage$=this.pageSubject$.pipe(B(e=>e),V(),h(1));isFirstLoading$=this.currentPage$.pipe(v(e=>e===1));stream=J({input:E([this.formValue$,this.currentPage$]),loader:([{name:e,email:i,registeredAfter:r,registeredBefore:c},u])=>this.clientApiService.searchClientsPaged$({name:e,email:i,registeredBefore:c?new Date(c):void 0,registeredAfter:r?new Date(r):void 0,page:u,pageSize:10})}).pipeValue(T((e,i)=>(i.page===1?e.data=i.data:e.data.push(...i.data),e.page=i.page,e.totalPages=i.totalPages,e),ae()));static \u0275fac=function(i){return new(i||t)};static \u0275cmp=D({type:t,selectors:[["app-infinite-scroll"]],decls:23,vars:12,consts:[[1,"p-6"],[3,"formValue$"],[1,"bg-white","shadow","rounded","overflow-hidden"],[1,"p-4","border-b"],[1,"text-lg","font-medium"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],["colspan","3"],[3,"reload","showReload"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],["colspan","3",1,"px-6","py-4","text-sm","text-gray-500"],["appIntersectionobserver","",1,"p-4","text-center","text-sm","text-gray-500",3,"loading"],["appIntersectionobserver","",1,"p-4","text-center","text-sm","text-gray-500",3,"isIntersecting"]],template:function(i,r){if(i&1&&(o(0,"div",0)(1,"app-clients-filter-form",1),x("formValue$",function(u){return r.formValue$.next(u)}),n(),o(2,"div",2)(3,"div",3)(4,"h3",4),p(5,"Clients"),n()(),o(6,"div",5)(7,"table",6),s(8,"async"),s(9,"async"),o(10,"thead",7)(11,"tr")(12,"th",8),p(13," Name "),n(),o(14,"th",8),p(15," Email "),n(),o(16,"th",8),p(17," Registered "),n()()(),f(18,Y,4,1,"tbody"),s(19,"async"),j(20,ie,2,3),n(),f(21,re,2,3),s(22,"async"),n()()()),i&2){let c,u;l(7),I("loading",m(8,4,r.stream.pending$)&&m(9,6,r.isFirstLoading$)),l(11),_((c=m(19,8,r.stream.error$))?18:20,c),l(3),_((u=m(22,10,r.stream.value$))?21:-1,u)}},dependencies:[z,U,H,K,Q,O,k],encapsulation:2})}return t})();export{ye as InfiniteScrollComponent};
