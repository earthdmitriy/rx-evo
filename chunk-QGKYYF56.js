import{a as ce}from"./chunk-GAAJMFTV.js";import{a as me}from"./chunk-DMFARG3C.js";import{a as _e}from"./chunk-IX3H5HXJ.js";import{a as re,b as pe,c as de,d as se}from"./chunk-ZSEMYRIX.js";import{a as le}from"./chunk-XFDKH5E3.js";import{c as Q,d as U,g as X,h as Y,i as Z,j as ee,k as te,l as ie,m as ne}from"./chunk-EAS7AI6F.js";import{a as oe}from"./chunk-2EMY2H7W.js";import{b as ae}from"./chunk-D7C7R5DL.js";import{$ as M,$a as r,Aa as j,Ba as _,C as P,Ca as L,Da as u,Fa as O,Ga as q,Ha as s,I as B,Ia as n,J as D,Ja as a,K as N,Ka as y,Oa as b,Qa as x,S as h,Sa as C,V as g,W as v,X as R,Y as I,_a as S,a as V,ab as k,b as $,bb as w,ca as A,f as W,fb as c,gb as f,hb as z,ma as l,p as T,q as F,rb as K,sb as H,ta as G,ub as J}from"./chunk-UHKDLVDU.js";var ue=(t,p)=>p.clientId;function Ce(t,p){if(t&1){let e=b();n(0,"tbody")(1,"tr")(2,"td",10)(3,"app-generic-error",11),x("reload",function(){g(e);let o=C();return v(o.stream.reload())}),a()()()()}t&2&&(l(3),s("showReload",!0))}function fe(t,p){t&1&&y(0,"app-client-info",20),t&2&&s("displayData",p)}function xe(t,p){if(t&1&&(n(0,"app-stateful-block",19),_(1,fe,1,1,"app-client-info",20),c(2,"async"),a()),t&2){let e,i=p;s("stream",i),l(),u((e=f(2,2,i))?1:-1,e)}}function ge(t,p){if(t&1&&(n(0,"tr",7)(1,"td",18),_(2,xe,3,4,"app-stateful-block",19),a()()),t&2){let e,i=C().$implicit,o=C(3);l(2),u((e=o.clientRequestFactory.get(i.clientId))?2:-1,e)}}function ve(t,p){if(t&1){let e=b();n(0,"tr")(1,"td",13)(2,"button",14),x("click",function(){let o=g(e).$implicit;return v(o.isExpanded.set(!o.isExpanded()))}),R(),n(3,"svg",15),y(4,"path",16),a()()(),I(),n(5,"td",13),r(6),a(),n(7,"td",17),r(8),a(),n(9,"td",17),r(10),c(11,"date"),a()(),_(12,ge,3,1,"tr",7)}if(t&2){let e=p.$implicit;l(2),S("text-gray-500",!e.isExpanded())("text-blue-600",e.isExpanded())("bg-gray-100",!e.isExpanded())("bg-blue-50",e.isExpanded()),j("aria-expanded",e.isExpanded()),l(),S("rotate-180",e.isExpanded()),l(3),w(" ",e.name," "),l(2),w(" ",e.email," "),l(2),w(" ",z(11,15,e.registeredAt,"medium")," "),l(2),u(e.isExpanded()?12:-1)}}function he(t,p){t&1&&(n(0,"tr")(1,"td",21),r(2," No results "),a()())}function ye(t,p){if(t&1&&(n(0,"tbody",12),O(1,ve,13,18,null,null,ue),_(3,he,3,0,"tr"),a()),t&2){let e=p;l(),q(e.data),l(2),u(e.data.length?-1:3)}}function be(t,p){if(t&1&&(_(0,ye,4,1,"tbody",12),c(1,"async")),t&2){let e,i=C();u((e=f(1,1,i.stream.value$))?0:-1,e)}}function Se(t,p){if(t&1){let e=b();n(0,"div",9)(1,"div",22)(2,"button",23),x("click",function(){let o=g(e),d=C();return v(d.prevPage(o))}),r(3," Prev "),a(),n(4,"button",23),c(5,"async"),x("click",function(){let o=g(e),d=C();return v(d.nextPage(o))}),r(6," Next "),a()(),n(7,"div",24)(8,"div",25),r(9," Page: "),n(10,"span",26),r(11),a()(),n(12,"label",25),r(13,"Page size "),n(14,"select",27)(15,"option",28),r(16,"5"),a(),n(17,"option",28),r(18,"10"),a(),n(19,"option",28),r(20,"20"),a()()(),n(21,"div",25),r(22," Total pages: "),n(23,"span",26),r(24),c(25,"async"),a()()()()}if(t&2){let e,i,o=p,d=C();s("formGroup",o),l(2),s("disabled",o.value.page===1),l(2),s("disabled",o.value.page===((e=f(5,8,d.stream.value$))==null?null:e.totalPages)),l(7),k(o.controls.page.value),l(4),s("value",5),l(2),s("value",10),l(2),s("value",20),l(5),k(((i=f(25,10,d.stream.value$))==null?null:i.totalPages)||0)}}var Ae=(()=>{class t{fb=h(ie);clientApiService=h(ae);destroyRef=h(M);formValue$=new W;pagination$=this.formValue$.pipe(T(()=>this.fb.group({page:this.fb.control(1),pageSize:this.fb.control(10)})),B(1));paginationValue$=this.pagination$.pipe(N(e=>e.valueChanges.pipe(D(e.value))));stream=de({input:F([this.formValue$,this.paginationValue$]).pipe(P(0)),loader:([{name:e,email:i,registeredAfter:o,registeredBefore:d},{page:m,pageSize:E}])=>this.clientApiService.searchClientsPaged$({name:e,email:i,registeredBefore:d?new Date(d):void 0,registeredAfter:o?new Date(o):void 0,page:m,pageSize:E}),cacheKey:([{name:e,email:i,registeredAfter:o,registeredBefore:d},{page:m,pageSize:E}])=>[e,i,o,d,m,E]}).pipeValue(T(e=>$(V({},e),{data:e.data.map(i=>$(V({},i),{isExpanded:A(!1)}))}))).pipe(me({name:"PaginationComponent Stream",actionName:e=>re(e)?"Loading...":pe(e)?"Error":"Value"}));clientRequestFactory=se({loader:e=>this.clientApiService.getClient$(e),cacheKey:e=>[e]});prevPage(e){let i=e.controls.page.value||1;e.patchValue({page:Math.max(1,i-1)})}nextPage(e){let i=e.controls.page.value||1;e.patchValue({page:i+1})}constructor(){this.destroyRef.onDestroy(()=>{this.clientRequestFactory.reset(!0)})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=G({type:t,selectors:[["app-with-collapse"]],decls:23,vars:10,consts:[[1,"p-6"],[3,"formValue$"],[1,"bg-white","shadow","rounded","overflow-hidden"],[1,"p-4","border-b"],[1,"text-lg","font-medium"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"p-4","border-t","flex","items-center","justify-between",3,"formGroup"],["colspan","4"],[3,"reload","showReload"],[1,"bg-white","divide-y","divide-gray-200"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],["title","Toggle details",1,"p-1","rounded","transition-colors","duration-150",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","aria-hidden","true",1,"w-4","h-4","transition-transform","duration-150"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],["colspan","4",1,"px-6","py-4"],[3,"stream"],[3,"displayData"],["colspan","3",1,"px-6","py-4","text-sm","text-gray-500"],[1,"flex","items-center","space-x-2"],[1,"px-3","py-1","bg-gray-100","rounded","disabled:opacity-50",3,"click","disabled"],[1,"flex","items-center","space-x-4"],[1,"text-sm","text-gray-600"],[1,"font-medium"],["formControlName","pageSize",1,"ml-2","rounded","border-gray-300"],[3,"value"]],template:function(i,o){if(i&1&&(n(0,"div",0)(1,"app-clients-filter-form",1),x("formValue$",function(m){return o.formValue$.next(m)}),a(),n(2,"div",2)(3,"div",3)(4,"h3",4),r(5,"Clients"),a()(),n(6,"div",5)(7,"table",6),c(8,"async"),n(9,"thead",7)(10,"tr"),y(11,"th",8),n(12,"th",8),r(13," Name "),a(),n(14,"th",8),r(15," Email "),a(),n(16,"th",8),r(17," Registered "),a()()(),_(18,Ce,4,1,"tbody"),c(19,"async"),L(20,be,2,3),a()(),_(21,Se,26,12,"div",9),c(22,"async"),a()()),i&2){let d,m;l(7),S("loading",f(8,4,o.stream.pending$)),l(11),u((d=f(19,6,o.stream.error$))?18:20,d),l(3),u((m=f(22,8,o.pagination$))?21:-1,m)}},dependencies:[_e,J,ne,ee,te,Z,Q,U,Y,X,le,ce,oe,K,H],encapsulation:2})}return t})();export{Ae as WithCollapseComponent};
