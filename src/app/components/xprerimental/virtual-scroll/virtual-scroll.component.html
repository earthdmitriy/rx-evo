<cdk-virtual-scroll-viewport
  #viewport
  [itemSize]="itemHeight"
  class="flex-1 flex flex-col w-full"
>
  <!-- table header (kept outside the virtual viewport so it stays fixed) -->
  <table
    class="bg-white shadow rounded min-w-full divide-y divide-gray-200 table-fixed w-full overflow-hidden"
  >
    <thead class="bg-gray-50">
      <tr>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        >
          Name
        </th>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        >
          Email
        </th>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        >
          Registered
        </th>
      </tr>
    </thead>

    <tbody>
      <tr *cdkVirtualFor="let client of stream.value$">
        @if (client) {
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
            {{ client.name }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            {{ client.email }}
          </td>
          <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
            {{ client.registeredAt | date: "medium" }}
          </td>
        } @else {
          <td
            class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"
            colspan="3"
          >
            Loading ...
          </td>
        }
      </tr>
      @if (!(stream.value$ | async)) {
        <tr class="loading">
          <td colspan="3" class="h-30"></td>
        </tr>
      }
    </tbody>
    <tfoot class="bg-gray-50">
      <tr>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        ></th>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        ></th>
        <th
          class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
        ></th>
      </tr>
    </tfoot>
  </table>
</cdk-virtual-scroll-viewport>
<div class="bg-white shadow rounded min-w-full table-fixed w-full mt-2 p-2">
  <div class="flex items-center justify-between gap-4">
    <div
      class="text-xs font-medium text-gray-500 uppercase tracking-wider px-4 py-1"
    >
      @if (viewport.getRenderedRange(); as range) {
        From {{ range.start }} to {{ range.end }}
      }
    </div>
    <div
      class="text-xs font-medium text-gray-500 uppercase tracking-wider px-4 py-1"
    >
      Total: {{ viewport.getDataLength() }}
    </div>
  </div>
</div>
